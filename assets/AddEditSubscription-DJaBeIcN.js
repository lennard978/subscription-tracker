import{b as C,r as l,j as e,u as E,a as q,f as O}from"./index-Dex1FOhz.js";import{a as h,u as R,C as T}from"./usePremium-CCeeSCzX.js";function I({value:c,onChange:m}){const{t:n}=C(),[r,s]=l.useState(!1),d=l.useRef(null),x=Object.keys(h);l.useEffect(()=>{const i=o=>{d.current&&!d.current.contains(o.target)&&s(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]);const u=h[c]||h.other;return e.jsxs("div",{className:"relative",ref:d,children:[e.jsxs("button",{type:"button",onClick:()=>s(i=>!i),className:`\r
          w-full flex items-center justify-between px-3 py-2 rounded-lg\r
          border border-gray-300 dark:border-gray-700\r
          bg-white dark:bg-gray-800 shadow-sm\r
        `,children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:u.icon}),e.jsx("span",{children:n(u.label)})]}),e.jsx("span",{className:"text-gray-500 dark:text-gray-300",children:"▾"})]}),r&&e.jsx("div",{className:`\r
            absolute left-0 right-0 mt-2 rounded-xl shadow-xl z-40\r
            bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700\r
            max-h-64 overflow-y-auto\r
          `,children:x.map(i=>{const o=h[i];return e.jsxs("button",{type:"button",onClick:()=>{m(i),s(!1)},className:`\r
                  w-full flex items-center gap-3 px-4 py-3 text-left\r
                  hover:bg-gray-100 dark:hover:bg-gray-800 transition\r
                `,children:[e.jsx("span",{className:"text-lg",children:o.icon}),e.jsx("span",{children:n(o.label)})]},i)})})]})}function A(){const c=E(),{showToast:m}=q(),{id:n}=O(),{t:r}=C(),s=R(),[d,x]=l.useState(""),[u,i]=l.useState(""),[o,N]=l.useState("monthly"),[y,_]=l.useState("other"),[g,k]=l.useState(""),[f,w]=l.useState(!0),[p,v]=l.useState("EUR"),S=["quarterly","semiannual","nine_months","biennial","triennial"];l.useEffect(()=>{if(n){const a=(JSON.parse(localStorage.getItem("subscriptions"))||[]).find(b=>b.id===Number(n));a&&(x(a.name),i(a.price),N(a.frequency),_(a.category||"other"),k(a.datePaid||""),w(a.notify!==!1),v(a.currency||"EUR"))}else{const t=localStorage.getItem("selected_currency");t&&v(t)}},[n]);const P=t=>{t.preventDefault();const a=JSON.parse(localStorage.getItem("subscriptions"))||[];if(!n&&!s.isPremium&&a.length>=5){c("/premium?reason=limit");return}if(!d.trim()){m(r("error_required"),"error");return}if(!u||Number(u)<=0){m(r("error_price_invalid"),"error");return}if(!g){m(r("error_paid_date_required"),"error");return}if(!s.isPremium&&S.includes(o)){c("/premium?reason=intervals");return}let b;n?(b=a.map(j=>j.id===Number(n)?{...j,name:d,price:Number(u),frequency:o,category:y,datePaid:g,notify:f,currency:p}:j),m(r("toast_updated"),"success")):(b=[...a,{id:Date.now(),name:d,price:Number(u),frequency:o,category:y,datePaid:g,notify:f,currency:p}],m(r("toast_added"),"success")),localStorage.setItem("subscriptions",JSON.stringify(b)),c("/dashboard")};return e.jsxs("div",{className:"max-w-md mx-auto mt-2 p-6 bg-white dark:bg-gray-900 rounded-xl shadow-lg border border-gray-200 dark:border-gray-800",children:[e.jsx("h1",{className:"text-xl font-semibold mb-6",children:r(n?"edit_title":"add_title")}),e.jsxs("form",{onSubmit:P,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("form_name")}),e.jsx("input",{className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:d,onChange:t=>x(t.target.value),placeholder:"Netflix, Gym, Adobe..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm",children:[r("form_price")," (",p,")"]}),e.jsx("input",{type:"number",step:"0.01",className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:u,onChange:t=>i(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("form_currency")}),s.isPremium?e.jsx(T,{value:p,onChange:v}):e.jsxs("button",{onClick:()=>c("/premium?reason=currency"),type:"button",className:"px-3 py-2 rounded-md border border-gray-300 dark:border-gray-700 text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300",children:["EUR · ",r("premium_locked_currency")]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("form_frequency")}),e.jsxs("select",{className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:o,onChange:t=>{if(!s.isPremium&&S.includes(t.target.value)){c("/premium?reason=intervals");return}N(t.target.value)},children:[e.jsx("option",{value:"weekly",children:r("form_weekly")}),e.jsx("option",{value:"biweekly",children:r("form_biweekly")}),e.jsx("option",{value:"monthly",children:r("form_monthly")}),e.jsx("option",{value:"quarterly",disabled:!s.isPremium,children:r("form_quarterly")}),e.jsx("option",{value:"semiannual",disabled:!s.isPremium,children:r("form_semiannual")}),e.jsx("option",{value:"nine_months",disabled:!s.isPremium,children:r("form_nine_months")}),e.jsx("option",{value:"yearly",children:r("form_yearly")}),e.jsx("option",{value:"biennial",disabled:!s.isPremium,children:r("form_biennial")}),e.jsx("option",{value:"triennial",disabled:!s.isPremium,children:r("form_triennial")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("form_category")}),e.jsx(I,{value:y,onChange:_})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("label_select_paid_date")}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:g,onChange:t=>k(t.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:f,onChange:t=>w(t.target.checked)}),e.jsx("label",{className:"text-sm",children:r("settings_notifications_info")})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition active:scale-95",children:r(n?"form_save":"add_subscription")}),e.jsx("button",{type:"button",onClick:()=>c("/dashboard"),className:"w-full sm:w-auto px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition active:scale-95",children:r("button_cancel")})]})]})]})}function J(){return e.jsx("div",{children:e.jsx(A,{})})}export{J as default};
