import{u as ne,a as oe,b as le,r as l,j as e}from"./index-CjG4metf.js";import{F as ce,a as ie,b as de}from"./index-Bd6YWQaq.js";function ue(t){switch(t){case"streaming":return"bg-purple-100 text-purple-800 dark:bg-purple-700/70 dark:text-purple-100";case"bills":return"bg-blue-100 text-blue-800 dark:bg-blue-700/70 dark:text-blue-100";case"gaming":return"bg-green-100 text-green-800 dark:bg-green-700/70 dark:text-green-100";case"software":return"bg-amber-100 text-amber-800 dark:bg-amber-700/70 dark:text-amber-100";default:return"bg-slate-100 text-slate-800 dark:bg-slate-700/70 dark:text-slate-100"}}function xe({item:t,onDelete:U,currency:W,rates:S,convert:v}){var Y;const B=ne(),{showToast:K}=oe(),{t:n}=le(),[o,V]=l.useState(t.datePaid?new Date(t.datePaid):null),[z,N]=l.useState(!1),c=144,[D,M]=l.useState(null),[T,_]=l.useState(null),[C,p]=l.useState(!1),[h,$]=l.useState(!1),[y,X]=l.useState(0),m=l.useRef(null),b=l.useRef(0),k=(a,r=.2,x=!1)=>{m.current&&cancelAnimationFrame(m.current);const d=()=>{X(s=>{let g=a-s,J=s+g*r;return x&&Math.abs(g)<6&&(J=a+(g>0?-3:3)),Math.abs(g)<.5?a:(m.current=requestAnimationFrame(d),J)})};m.current=requestAnimationFrame(d)},P=()=>{navigator&&"vibrate"in navigator&&navigator.vibrate(10)},G=a=>{const r=a.touches[0];M(r.clientX),_(r.clientY),b.current=y,$(!0)},H=a=>{if(D==null||T==null)return;const r=a.touches[0],x=r.clientX-D,d=r.clientY-T;if(Math.abs(d)>10)return;let s=C?-c+x:x;s<-c&&(s=-c-Math.abs(s+c)*.2),s>0&&(s=s*.3),b.current=s,X(s)},Q=()=>{$(!1),b.current<-c*.4?(p(!0),k(-c,.22,!0),P()):(p(!1),k(0,.22,!0),P()),M(null),_(null)},Z=()=>{p(!1),k(0,.22,!0)},ee=a=>{const r=new Date(a.target.value);V(r);const d=(JSON.parse(localStorage.getItem("subscriptions"))||[]).map(s=>s.id===t.id?{...s,datePaid:r.toISOString()}:s);localStorage.setItem("subscriptions",JSON.stringify(d)),K(n("toast_paid_set",{date:r.toLocaleDateString()}),"success"),N(!1)},te={weekly:{days:7},biweekly:{days:14},monthly:{months:1},quarterly:{months:3},semiannual:{months:6},nine_months:{months:9},yearly:{months:12},biennial:{months:24},triennial:{months:36}},E=new Date,i=o?new Date(o):null;if(i){const a=te[t.frequency]||{months:1};a.months&&i.setMonth(i.getMonth()+a.months),a.days&&i.setDate(i.getDate()+a.days)}const w=o&&i?Math.round((i-o)/(1e3*60*60*24)):0,F=o?Math.round((E-o)/(1e3*60*60*24)):0,j=w-F,f=w>0?Math.min(100,Math.round(F/w*100)):0,I=2*Math.PI*16,ae=I*(1-f/100),se=f>=90?"text-red-500":f>=50?"text-yellow-400":"text-green-500",q=((Y=t.category)==null?void 0:Y.toLowerCase().replace(/\s+/g,"_"))||"other",u=Math.max(0,Math.min(1,Math.abs(y)/c)),A=(1-u)*20,O=.85+.15*u,R=.25+.75*u,L=W||t.currency||"EUR",re=S&&v?v(t.price,t.currency||"EUR",L,S):t.price;return e.jsxs("div",{className:"relative w-full",style:{touchAction:"pan-y"},children:[e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-stretch pr-2",style:{transform:`translateX(${(1-u)*10}px)`,opacity:.8+.2*u,transition:h?"none":"transform 150ms ease-out, opacity 150ms ease-out"},children:[e.jsxs("button",{onClick:()=>B(`/edit/${t.id}`),className:"flex-1 min-w-[3.5rem] bg-gray-500 text-white flex flex-col items-center justify-center text-[11px] rounded-l-xl",style:{transform:`translateX(${A}px) scale(${O})`,opacity:R,transition:h?"none":"transform 150ms ease-out, opacity 150ms ease-out"},children:[e.jsx(ce,{className:"mb-0.5"}),n("button_edit")]}),e.jsxs("button",{onClick:()=>U(t.id),className:"flex-1 min-w-[4.2rem] bg-red-600 text-white flex flex-col items-center justify-center text-[11px] rounded-r-xl",style:{transform:`translateX(${A}px) scale(${O})`,opacity:R,transition:h?"none":"transform 150ms ease-out, opacity 150ms ease-out"},children:[e.jsx(ie,{className:"mb-0.5"}),n("button_delete")]})]}),e.jsxs("div",{className:`relative p-4 w-full 
          bg-white/70 dark:bg-slate-900/80 
          rounded-2xl border border-white/40 dark:border-slate-700
          backdrop-blur-md flex flex-col gap-3
          ${h?"shadow-xl scale-[1.01]":"shadow-md scale-[1.0]"}
          transition-all duration-150
        `,style:{transform:`translateX(${y}px)`,userSelect:"none",touchAction:"pan-y"},onTouchStart:G,onTouchMove:H,onTouchEnd:Q,onClick:C?Z:void 0,children:[e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("div",{className:"font-semibold text-base text-gray-900 dark:text-gray-100 truncate",children:t.name}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:`${L} ${re.toFixed(2)} / ${n(`frequency_${t.frequency}`)}`}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:j<0?n("label_overdue",{days:Math.abs(j)}):n("label_renews_in",{days:j})})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-[10px] rounded-full ${ue(q)}`,children:n(`category_${q}`)}),o&&e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 40 40",className:"-rotate-90",children:[e.jsx("circle",{cx:"20",cy:"20",r:"16",stroke:"currentColor",className:"text-gray-300 dark:text-gray-700",strokeWidth:"4",fill:"transparent"}),e.jsx("circle",{cx:"20",cy:"20",r:"16",stroke:"currentColor",className:se,strokeWidth:"4",fill:"transparent",strokeDasharray:I,strokeDashoffset:ae,strokeLinecap:"round"})]}),e.jsxs("span",{className:"absolute text-[10px] text-gray-700 dark:text-gray-300",children:[f,"%"]})]})]})]}),o&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:n("label_last_paid",{date:o.toLocaleDateString()})}),z&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm block text-gray-600 dark:text-gray-300 mb-1",children:n("label_select_paid_date")}),e.jsx("input",{type:"date",onChange:ee,defaultValue:E.toISOString().split("T")[0],className:"w-full sm:w-1/2 px-3 py-2 rounded-md border dark:bg-gray-700 dark:text-white"})]}),e.jsxs("button",{onClick:()=>N(!0),className:"inline-flex items-center gap-1 px-2 py-1 bg-green-600 text-white rounded-md text-xs self-start",children:[e.jsx(de,{className:"text-[10px]"}),n("button_paid")]})]})]})}function fe(){return e.jsx("div",{children:e.jsx(xe,{})})}export{fe as default};
