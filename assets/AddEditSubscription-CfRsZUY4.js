import{u as C,a as q,h as E,b as O,f as F,r as n,j as e}from"./index-C9yXFqcu.js";import{C as I}from"./CurrencySelector-CMUIfwBF.js";function R(){const l=C(),{showToast:o}=q(),{id:i}=E(),{t:r}=O(),s=F(),[u,f]=n.useState(""),[d,v]=n.useState(""),[m,j]=n.useState("monthly"),[p,_]=n.useState("Other"),[b,N]=n.useState(""),[g,k]=n.useState(!0),[x,y]=n.useState("EUR"),w=["quarterly","semiannual","nine_months","biennial","triennial"],S=["Streaming","Fitness","Software","Productivity","Gaming","Bills","Education","Transport","Food","Other"];n.useEffect(()=>{if(i){const t=(JSON.parse(localStorage.getItem("subscriptions"))||[]).find(c=>c.id===Number(i));t&&(f(t.name),v(t.price),j(t.frequency),_(t.category||"Other"),N(t.datePaid||""),k(t.notify!==!1),y(t.currency||"EUR"))}else{const a=localStorage.getItem("selected_currency");a&&y(a)}},[i]);const P=a=>{a.preventDefault();const t=JSON.parse(localStorage.getItem("subscriptions"))||[];if(!i&&!s.isPremium&&t.length>=5){l("/premium?reason=limit");return}if(!u.trim()){o(r("error_required"),"error");return}if(!d||Number(d)<=0){o(r("error_price_invalid"),"error");return}if(!b){o(r("error_paid_date_required"),"error");return}if(!s.isPremium&&w.includes(m)){l("/premium?reason=intervals");return}let c;i?(c=t.map(h=>h.id===Number(i)?{...h,name:u,price:Number(d),frequency:m,category:p,datePaid:b,notify:g,currency:x}:h),o(r("toast_updated"),"success")):(c=[...t,{id:Date.now(),name:u,price:Number(d),frequency:m,category:p,datePaid:b,notify:g,currency:x}],o(r("toast_added"),"success")),localStorage.setItem("subscriptions",JSON.stringify(c)),l("/dashboard")};return e.jsxs("div",{className:"max-w-md mx-auto mt-2 p-6 bg-white dark:bg-gray-900 rounded-xl shadow-lg border border-gray-200 dark:border-gray-800",children:[e.jsx("h1",{className:"text-xl font-semibold mb-6",children:r(i?"edit_title":"add_title")}),e.jsxs("form",{onSubmit:P,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("form_name")}),e.jsx("input",{className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:u,onChange:a=>f(a.target.value),placeholder:"Netflix, Gym, Adobe..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm",children:[r("form_price")," (",x,")"]}),e.jsx("input",{type:"number",step:"0.01",className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:d,onChange:a=>v(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("form_currency")}),s.isPremium?e.jsx(I,{value:x,onChange:y}):e.jsxs("button",{onClick:()=>l("/premium?reason=currency"),type:"button",className:"px-3 py-2 rounded-md border border-gray-300 dark:border-gray-700 text-xs bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300",children:["EUR Â· ",r("premium_locked_currency")]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("form_frequency")}),e.jsxs("select",{className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:m,onChange:a=>{if(!s.isPremium&&w.includes(a.target.value)){l("/premium?reason=intervals");return}j(a.target.value)},children:[e.jsx("option",{value:"weekly",children:r("form_weekly")}),e.jsx("option",{value:"biweekly",children:r("form_biweekly")}),e.jsx("option",{value:"monthly",children:r("form_monthly")}),e.jsx("option",{value:"quarterly",disabled:!s.isPremium,children:r("form_quarterly")}),e.jsx("option",{value:"semiannual",disabled:!s.isPremium,children:r("form_semiannual")}),e.jsx("option",{value:"nine_months",disabled:!s.isPremium,children:r("form_nine_months")}),e.jsx("option",{value:"yearly",children:r("form_yearly")}),e.jsx("option",{value:"biennial",disabled:!s.isPremium,children:r("form_biennial")}),e.jsx("option",{value:"triennial",disabled:!s.isPremium,children:r("form_triennial")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("form_category")}),e.jsx("select",{className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:p,onChange:a=>_(a.target.value),children:S.map(a=>e.jsx("option",{value:a,children:r(`category_${a.toLowerCase()}`)||a},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm",children:r("label_select_paid_date")}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 rounded-md border dark:bg-gray-800",value:b,onChange:a=>N(a.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:a=>k(a.target.checked)}),e.jsx("label",{className:"text-sm",children:r("settings_notifications_info")})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition active:scale-95",children:r(i?"form_save":"add_subscription")}),e.jsx("button",{type:"button",onClick:()=>l("/dashboard"),className:"w-full sm:w-auto px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition active:scale-95",children:r("button_cancel")})]})]})]})}function J(){return e.jsx("div",{children:e.jsx(R,{})})}export{J as default};
